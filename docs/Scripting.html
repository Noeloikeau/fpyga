---

title: Scripting


keywords: fastai
sidebar: home_sidebar

summary: "Automatically detect hardware and devices like FPGAs and SoCs, read/write to memory, program, compile, archive projects, generate LUT masks, perform timing analyses, and more."
description: "Automatically detect hardware and devices like FPGAs and SoCs, read/write to memory, program, compile, archive projects, generate LUT masks, perform timing analyses, and more."
nb_path: "01_Scripting.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_Scripting.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Anaconda3\lib\site-packages\numpy\_distributor_init.py:32: UserWarning: loaded more than 1 DLL from .libs:
C:\Anaconda3\lib\site-packages\numpy\.libs\libopenblas.NOIJJG62EMASZI6NYURL6JBKM4EVBGM7.gfortran-win_amd64.dll
C:\Anaconda3\lib\site-packages\numpy\.libs\libopenblas.PYQHXLVVQ7VESDPUVUADXEVJOBGHJPAY.gfortran-win_amd64.dll
  stacklevel=1)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Quartus-Shell-and-Device-Detection">Quartus Shell and Device Detection<a class="anchor-link" href="#Quartus-Shell-and-Device-Detection"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="qshell" class="doc_header"><code>qshell</code><a href="https://github.com/Noeloikeau/fpyga/tree/master/fpyga/scripting.py#L16" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>qshell</code>(<strong><code>func</code></strong>)</p>
</blockquote>
<p>Function decorator that opens quartustcl shell if none open.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the following I will use two DE-10 Nano SoC FPGAs attached via USB. Note that function wrappers disrupt the automatically generated doc strings created by nbdev. As such, we will show the source code for details.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="qshell.<locals>.wrap" class="doc_header"><code>qshell.<locals>.wrap</code><a href="https://github.com/Noeloikeau/fpyga/tree/master/fpyga/scripting.py#L18" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>qshell.<locals>.wrap</code>(<strong><code>q</code></strong>=<em><code>None</code></em>, <strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@qshell</span>
<span class="k">def</span> <span class="nf">get_fpgas</span><span class="p">(</span><span class="n">q</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">quartustcl</span><span class="o">.</span><span class="n">QuartusTcl</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">parse</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>            
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Get all connected FPGAs and SOCs as lists of hardware names `hwnames` and device names `devnames`.</span>
<span class="sd">    Uses `q` shell if given, otherwise opens new shell. If `parse`, extracts only the FPGA, ignoring SoCs.</span>
<span class="sd">    Returns a dict keyed by hardware port (e.g USB) and valued with devices (e.g FPGA/SOC).</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">hwnames</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">get_hardware_names</span><span class="p">())</span>
    <span class="n">devnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">get_device_names</span><span class="p">(</span><span class="n">hardware_name</span><span class="o">=</span><span class="n">h</span><span class="p">))</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">hwnames</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">parse</span><span class="p">:</span>
        <span class="n">devnames</span><span class="o">=</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">devnames</span><span class="p">]</span> <span class="c1">#SoC is always first, if it exists</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">hwnames</span><span class="p">,</span><span class="n">devnames</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_fpgas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;DE-SoC [USB-1]&#39;: [&#39;@1: SOCVHPS (0x4BA00477)&#39;,
  &#39;@2: 5CSEBA6(.|ES)/5CSEMA6/.. (0x02D020DD)&#39;],
 &#39;DE-SoC [USB-2]&#39;: [&#39;@1: SOCVHPS (0x4BA00477)&#39;,
  &#39;@2: 5CSEBA6(.|ES)/5CSEMA6/.. (0x02D020DD)&#39;]}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_fpgas</span><span class="p">(</span><span class="n">parse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1">#strip the SoC</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;DE-SoC [USB-1]&#39;: &#39;@2: 5CSEBA6(.|ES)/5CSEMA6/.. (0x02D020DD)&#39;,
 &#39;DE-SoC [USB-2]&#39;: &#39;@2: 5CSEBA6(.|ES)/5CSEMA6/.. (0x02D020DD)&#39;}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="qshell.<locals>.wrap" class="doc_header"><code>qshell.<locals>.wrap</code><a href="https://github.com/Noeloikeau/fpyga/tree/master/fpyga/scripting.py#L18" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>qshell.<locals>.wrap</code>(<strong><code>q</code></strong>=<em><code>None</code></em>, <strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@qshell</span>
<span class="k">def</span> <span class="nf">get_insts</span><span class="p">(</span><span class="n">q</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
              <span class="n">N_levels</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
              <span class="n">hwnames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">devnames</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Get all memory instances from `hwname` and `devname`. See `QuartusTcl` doc for `N_levels`.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">hwnames</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">devnames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">device_dict</span><span class="o">=</span><span class="n">get_fpgas</span><span class="p">(</span><span class="n">parse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">hwnames</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">device_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">devnames</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">device_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="s1">&#39;Finds instance index given a name `inst_name` (string).&#39;</span>
    <span class="n">memories</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">hwname</span><span class="p">,</span><span class="n">devname</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">hwnames</span><span class="p">,</span><span class="n">devnames</span><span class="p">):</span>
        <span class="n">memories_raw</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">get_editable_mem_instances</span><span class="p">(</span><span class="n">hardware_name</span><span class="o">=</span><span class="n">hwname</span><span class="p">,</span>\
            <span class="n">device_name</span><span class="o">=</span><span class="n">devname</span><span class="p">)</span>
        <span class="n">memories</span><span class="p">[</span><span class="n">hwname</span><span class="p">]</span><span class="o">=</span><span class="n">q</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">memories_raw</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">N_levels</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">memories</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_insts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;DE-SoC [USB-1]&#39;: [[&#39;0&#39;, &#39;1&#39;, &#39;1&#39;, &#39;RW&#39;, &#39;ROM/RAM&#39;, &#39;BIT&#39;],
  [&#39;1&#39;, &#39;1&#39;, &#39;3&#39;, &#39;RW&#39;, &#39;ROM/RAM&#39;, &#39;MULT&#39;],
  [&#39;2&#39;, &#39;512&#39;, &#39;1300&#39;, &#39;RW&#39;, &#39;ROM/RAM&#39;, &#39;READ&#39;],
  [&#39;3&#39;, &#39;512&#39;, &#39;1300&#39;, &#39;RW&#39;, &#39;ROM/RAM&#39;, &#39;READ&#39;],
  [&#39;4&#39;, &#39;512&#39;, &#39;1300&#39;, &#39;RW&#39;, &#39;ROM/RAM&#39;, &#39;READ&#39;]],
 &#39;DE-SoC [USB-2]&#39;: [[&#39;0&#39;, &#39;1&#39;, &#39;1&#39;, &#39;RW&#39;, &#39;ROM/RAM&#39;, &#39;BIT&#39;],
  [&#39;1&#39;, &#39;1&#39;, &#39;3&#39;, &#39;RW&#39;, &#39;ROM/RAM&#39;, &#39;MULT&#39;],
  [&#39;2&#39;, &#39;512&#39;, &#39;1300&#39;, &#39;RW&#39;, &#39;ROM/RAM&#39;, &#39;READ&#39;],
  [&#39;3&#39;, &#39;512&#39;, &#39;1300&#39;, &#39;RW&#39;, &#39;ROM/RAM&#39;, &#39;READ&#39;],
  [&#39;4&#39;, &#39;512&#39;, &#39;1300&#39;, &#39;RW&#39;, &#39;ROM/RAM&#39;, &#39;READ&#39;]]}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The dict is keyed by port, and valued by a list of lists. Each sublist gives a memory address. The first entry is the memory index, the second is the number of words, the third is the size of each word, the fourth is the RW behavior, the 5th is the type of memory, and the last is the name of the memory module.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="begin_mem" class="doc_header"><code>begin_mem</code><a href="https://github.com/Noeloikeau/fpyga/tree/master/fpyga/scripting.py#L64" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>begin_mem</code>(<strong><code>q</code></strong>=<em><code>None</code></em>, <strong><code>hw</code></strong>=<em><code>'DE-SoC [USB-1]'</code></em>, <strong><code>dev</code></strong>=<em><code>'@2: 5CSEBA6(.|ES)/5CSEMA6/.. (0x02D020DD)'</code></em>)</p>
</blockquote>
<p>Open a memory edit. If one is already open, pass.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="end_mem" class="doc_header"><code>end_mem</code><a href="https://github.com/Noeloikeau/fpyga/tree/master/fpyga/scripting.py#L75" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>end_mem</code>(<strong><code>q</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>End a memory edit. If there are none open, pass.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Reading-/-writing-to-memory">Reading / writing to memory<a class="anchor-link" href="#Reading-/-writing-to-memory"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="qshell.<locals>.wrap" class="doc_header"><code>qshell.<locals>.wrap</code><a href="https://github.com/Noeloikeau/fpyga/tree/master/fpyga/scripting.py#L18" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>qshell.<locals>.wrap</code>(<strong><code>q</code></strong>=<em><code>None</code></em>, <strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@qshell</span>
<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">inst</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
         <span class="n">hw</span><span class="o">=</span><span class="s1">&#39;DE-SoC [USB-1]&#39;</span><span class="p">,</span>
         <span class="n">dev</span><span class="o">=</span><span class="s1">&#39;@2: 5CSEBA6(.|ES)/5CSEMA6/.. (0x02D020DD)&#39;</span><span class="p">,</span>
         <span class="n">begin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
         <span class="n">end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
         <span class="n">fname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">delete_mif</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Reads memory from an instance `inst` into an array `data`.</span>
<span class="sd">    Option `delete_mif` will delete temporary .mif file if set to `True`.&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">begin</span><span class="p">:</span>
        <span class="n">begin_mem</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">hw</span><span class="o">=</span><span class="n">hw</span><span class="p">,</span><span class="n">dev</span><span class="o">=</span><span class="n">dev</span><span class="p">)</span>
    <span class="n">fname</span><span class="o">=</span><span class="n">fname</span> <span class="ow">or</span> <span class="s1">&#39;read_inst</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span>
    <span class="n">q</span><span class="o">.</span><span class="n">save_content_from_memory_to_file</span><span class="p">(</span>
        <span class="n">instance_index</span><span class="o">=</span><span class="n">inst</span><span class="p">,</span>
        <span class="n">mem_file_path</span><span class="o">=</span><span class="n">fname</span><span class="p">,</span>
        <span class="n">mem_file_type</span><span class="o">=</span><span class="s1">&#39;mif&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">mif</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">delete_mif</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">end</span><span class="p">:</span>
        <span class="n">end_mem</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">read</span><span class="p">(</span><span class="n">inst</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">hw</span><span class="o">=</span><span class="s1">&#39;DE-SoC [USB-1]&#39;</span><span class="p">,</span><span class="n">dev</span><span class="o">=</span><span class="s1">&#39;@2: 5CSEBA6(.|ES)/5CSEMA6/.. (0x02D020DD)&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0, 0, 0]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="format_mem" class="doc_header"><code>format_mem</code><a href="https://github.com/Noeloikeau/fpyga/tree/master/fpyga/scripting.py#L113" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>format_mem</code>(<strong><code>data</code></strong>, <strong><code>bits</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Format input data to nested array required for memory</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">format_mem</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">format_mem</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[1, 0, 1, 0]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">format_mem</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0, 1, 2]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="qshell.<locals>.wrap" class="doc_header"><code>qshell.<locals>.wrap</code><a href="https://github.com/Noeloikeau/fpyga/tree/master/fpyga/scripting.py#L18" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>qshell.<locals>.wrap</code>(<strong><code>q</code></strong>=<em><code>None</code></em>, <strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@qshell</span>
<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">inst</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
          <span class="n">data</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
          <span class="n">hw</span><span class="o">=</span><span class="s1">&#39;DE-SoC [USB-1]&#39;</span><span class="p">,</span>
          <span class="n">dev</span><span class="o">=</span><span class="s1">&#39;@2: 5CSEBA6(.|ES)/5CSEMA6/.. (0x02D020DD)&#39;</span><span class="p">,</span>
          <span class="n">bits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">begin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
          <span class="n">end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
          <span class="n">fname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">delete_mif</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Writes `data` array to memory instance `inst`.</span>
<span class="sd">    Option `delete_mif` will delete temporary .mif file if set to `True`.&#39;&#39;&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">format_mem</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">bits</span><span class="o">=</span><span class="n">bits</span><span class="p">)</span>
    <span class="n">fname</span><span class="o">=</span><span class="n">fname</span> <span class="ow">or</span> <span class="s1">&#39;write_inst</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">begin</span><span class="p">:</span>
        <span class="n">begin_mem</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">hw</span><span class="p">,</span><span class="n">dev</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">mif</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">q</span><span class="o">.</span><span class="n">update_content_to_memory_from_file</span><span class="p">(</span>
        <span class="n">instance_index</span><span class="o">=</span><span class="n">inst</span><span class="p">,</span>
        <span class="n">mem_file_path</span><span class="o">=</span><span class="n">fname</span><span class="p">,</span>
        <span class="n">mem_file_type</span><span class="o">=</span><span class="s1">&#39;mif&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">end</span><span class="p">:</span>
        <span class="n">end_mem</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">delete_mif</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">write</span><span class="p">(</span><span class="n">inst</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">read</span><span class="p">(</span><span class="n">inst</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[1, 0, 1]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="qshell.<locals>.wrap" class="doc_header"><code>qshell.<locals>.wrap</code><a href="https://github.com/Noeloikeau/fpyga/tree/master/fpyga/scripting.py#L18" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>qshell.<locals>.wrap</code>(<strong><code>q</code></strong>=<em><code>None</code></em>, <strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@qshell</span>
<span class="k">def</span> <span class="nf">read_write</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">args</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">]],</span>
              <span class="n">hw</span><span class="o">=</span><span class="s1">&#39;DE-SoC [USB-1]&#39;</span><span class="p">,</span>
              <span class="n">dev</span><span class="o">=</span><span class="s1">&#39;@2: 5CSEBA6(.|ES)/5CSEMA6/.. (0x02D020DD)&#39;</span><span class="p">,</span>
              <span class="n">reps</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
              <span class="n">begin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">end</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Read/write using `args`, a list of lists/tuples each of the form</span>
<span class="sd">    (instance index, &#39;r&#39; or &#39;w&#39;, data to write if &#39;w&#39;, bits to use if &#39;w&#39;).</span>
<span class="sd">    Can repeat operation up to `reps`.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">data</span><span class="o">=</span><span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reps</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">begin</span><span class="p">:</span>
        <span class="n">begin_mem</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">hw</span><span class="o">=</span><span class="n">hw</span><span class="p">,</span><span class="n">dev</span><span class="o">=</span><span class="n">dev</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reps</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">tup</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="n">inst</span><span class="o">=</span><span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;r&#39;</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="p">[</span><span class="n">read</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">inst</span><span class="o">=</span><span class="n">inst</span><span class="p">,</span><span class="n">hw</span><span class="o">=</span><span class="n">hw</span><span class="p">,</span><span class="n">dev</span><span class="o">=</span><span class="n">dev</span><span class="p">,</span><span class="n">begin</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
            <span class="k">elif</span> <span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;w&#39;</span><span class="p">:</span>
                <span class="n">x</span><span class="o">=</span><span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tup</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
                    <span class="n">b</span><span class="o">=</span><span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">b</span><span class="o">=</span><span class="n">tup</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                <span class="n">x</span><span class="o">=</span><span class="n">format_mem</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">bits</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>
                <span class="n">write</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">inst</span><span class="o">=</span><span class="n">inst</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">hw</span><span class="o">=</span><span class="n">hw</span><span class="p">,</span><span class="n">dev</span><span class="o">=</span><span class="n">dev</span><span class="p">,</span><span class="n">begin</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">end</span><span class="p">:</span>
        <span class="n">end_mem</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">!=</span><span class="p">[]:</span>
        <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">==</span><span class="p">():</span>
            <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">data</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">read_write</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0, 0, 0])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">read_write</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([1, 1, 1])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">read_write</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)],</span><span class="n">reps</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[1, 1, 1],
       [1, 1, 1]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">read_write</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[1, 1, 1],
       [0, 0, 0]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="qshell.<locals>.wrap" class="doc_header"><code>qshell.<locals>.wrap</code><a href="https://github.com/Noeloikeau/fpyga/tree/master/fpyga/scripting.py#L18" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>qshell.<locals>.wrap</code>(<strong><code>q</code></strong>=<em><code>None</code></em>, <strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@qshell</span>
<span class="k">def</span> <span class="nf">read_write_all</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">args</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">]],</span>
                 <span class="n">fpgas</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;DE-SoC [USB-1]&#39;</span><span class="p">,</span><span class="s1">&#39;@2: 5CSEBA6(.|ES)/5CSEMA6/.. (0x02D020DD)&#39;</span><span class="p">]],</span>
                 <span class="n">reps</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">begin</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">end</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">data</span><span class="o">=</span><span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fpgas</span><span class="p">))]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,(</span><span class="n">hw</span><span class="p">,</span><span class="n">dev</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fpgas</span><span class="p">):</span>
        <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">read_write</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span><span class="n">hw</span><span class="o">=</span><span class="n">hw</span><span class="p">,</span><span class="n">dev</span><span class="o">=</span><span class="n">dev</span><span class="p">,</span><span class="n">reps</span><span class="o">=</span><span class="n">reps</span><span class="p">,</span><span class="n">begin</span><span class="o">=</span><span class="n">begin</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">!=</span><span class="p">[]:</span>
        <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">read_write_all</span><span class="p">(</span><span class="n">fpgas</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;DE-SoC [USB-1]&#39;</span><span class="p">,</span><span class="s1">&#39;@2: 5CSEBA6(.|ES)/5CSEMA6/.. (0x02D020DD)&#39;</span><span class="p">),</span>
                     <span class="p">(</span><span class="s1">&#39;DE-SoC [USB-2]&#39;</span><span class="p">,</span><span class="s1">&#39;@2: 5CSEBA6(.|ES)/5CSEMA6/.. (0x02D020DD)&#39;</span><span class="p">)],</span>
              <span class="n">args</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[[1, 1, 1],
        [0, 0, 0]],

       [[1, 1, 1],
        [0, 0, 0]]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Programming,-compiling,-archiving">Programming, compiling, archiving<a class="anchor-link" href="#Programming,-compiling,-archiving"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="program_proj" class="doc_header"><code>program_proj</code><a href="https://github.com/Noeloikeau/fpyga/tree/master/fpyga/scripting.py#L209" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>program_proj</code>(<strong><code>projectname</code></strong>, <strong><code>hw</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>'output_files'</code></em>)</p>
</blockquote>
<p>Program a single FPGA using a .cdf file.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="compile_proj" class="doc_header"><code>compile_proj</code><a href="https://github.com/Noeloikeau/fpyga/tree/master/fpyga/scripting.py#L223" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>compile_proj</code>(<strong><code>projectname</code></strong>)</p>
</blockquote>
<p>Compiles <code>Quartus</code> project <code>projectname</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="archive_proj" class="doc_header"><code>archive_proj</code><a href="https://github.com/Noeloikeau/fpyga/tree/master/fpyga/scripting.py#L228" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>archive_proj</code>(<strong><code>projectname</code></strong>, <strong><code>filename</code></strong>, <strong><code>path</code></strong>=<em><code>''</code></em>)</p>
</blockquote>
<p>Generates a <code>projectname-date.qar</code> file which Quartus can use to restore all project files.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Location-and-routing-annotation-and-QSF-file-appending">Location and routing annotation and QSF file appending<a class="anchor-link" href="#Location-and-routing-annotation-and-QSF-file-appending"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="back_annotate" class="doc_header"><code>back_annotate</code><a href="https://github.com/Noeloikeau/fpyga/tree/master/fpyga/scripting.py#L235" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>back_annotate</code>(<strong><code>projectname</code></strong>, <strong><code>routing</code></strong>=<em><code>True</code></em>, <strong><code>logic</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Writes all routing and logic to the qsf file.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="write_qsf" class="doc_header"><code>write_qsf</code><a href="https://github.com/Noeloikeau/fpyga/tree/master/fpyga/scripting.py#L245" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>write_qsf</code>(<strong><code>txt</code></strong>=<em><code>''</code></em>, <strong><code>style</code></strong>=<em><code>'w'</code></em>, <strong><code>projectname</code></strong>=<em><code>'DE10'</code></em>, <strong><code>sourcename</code></strong>=<em><code>'qsf_source.qsf'</code></em>, <strong><code>set_source</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Writes assignments <code>txt</code> to <code>sourcename</code> and includes them in <code>projectname</code>.qsf.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="LUT-Masks">LUT Masks<a class="anchor-link" href="#LUT-Masks"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="lut_mask" class="doc_header"><code>lut_mask</code><a href="https://github.com/Noeloikeau/fpyga/tree/master/fpyga/scripting.py#L259" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>lut_mask</code>(<strong><code>lut</code></strong>=<em><code>&lt;lambda&gt;</code></em>, <strong><code>N</code></strong>=<em><code>4</code></em>)</p>
</blockquote>
<p>Quartus LUT mask for primitive logic cell, takes function to input and returns hex encoding
in:
    lut (callable or list or numpy.array or dict) : function mapping over the port entry.
    N (int) : number of ports. for standard 4-input LUT, 0=d, 1=c, 2=b, 3=a
out:
    mask (str) : hex string encoding of the given mask</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lut_mask</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span><span class="mi">1</span> <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;0x00ff&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Timing-analysis">Timing analysis<a class="anchor-link" href="#Timing-analysis"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="analyze_timing" class="doc_header"><code>analyze_timing</code><a href="https://github.com/Noeloikeau/fpyga/tree/master/fpyga/scripting.py#L278" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>analyze_timing</code>(<strong><code>projectname</code></strong>, <strong><code>_from</code></strong>=<em><code>'[get_clocks {MyClock}]'</code></em>, <strong><code>_to</code></strong>=<em><code>'[get_cells {MyCell}]'</code></em>, <strong><code>detail</code></strong>=<em><code>'summary'</code></em>, <strong><code>filename</code></strong>=<em><code>'timing.txt'</code></em>, <strong><code>npaths</code></strong>=<em><code>1</code></em>)</p>
</blockquote>
<p>Runs the timing analyzer, getting path information from <code>_from</code> to <code>_to</code>.
Gives <code>detail</code> (summary or full_path) on <code>npaths</code> and generates <code>filename</code>.
Returns text of that file.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

